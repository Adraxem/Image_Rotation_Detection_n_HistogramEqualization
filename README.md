# Image Rotation Detection and Line Fitting

This repository contains code for detecting and analyzing image rotations by performing edge detection and line fitting on images. The main objective is to identify the correct alignment of rotated images by comparing histograms of line angles and lengths between rotated and template images.

### Key Features
- **Edge Detection & Line Fitting**:
  - Uses Canny edge detection and Hough Line Transform to detect lines in the input images.
  - The detected lines are fitted, and their angles and lengths are extracted for analysis.
  
- **Histogram Generation**:
  - Histograms of line angles (in degrees) and corresponding line lengths are generated for each image.
  - The histograms are used to compare rotated images with template images.

- **Rotation Angle Estimation**:
  - For each rotated image, the code finds the best matching template image based on the histogram comparison.
  - The estimated rotation angle is calculated by minimizing the distance (Euclidean norm) between the rotated and template histograms.

- **Rotation Correction**:
  - Based on the estimated rotation angles, the code can correct the rotation of the rotated images and save the corrected versions.

### Workflow
1. **Edge Detection**:
   - Edge detection is applied to both the rotated and template images using Canny edge detection.
   - Lines are detected using the Hough Line Transform, and line angles and lengths are stored.

2. **Line Length Histogram**:
   - A histogram is generated by grouping the angles into bins, with the sum of line lengths in each bin.
   - Separate histograms are created for rotated and template images.

3. **Rotation Angle Calculation**:
   - The histograms of rotated and template images are compared using the Euclidean distance to find the best match.
   - The rotation angle is estimated based on the optimal shift between the histograms.

4. **Rotation Correction**:
   - Once the rotation angle is estimated, the rotated images are aligned with the template images and saved as new files.

### Directory Structure
- **Input Directories**:
  - `rotated_edges`: Contains the rotated images.
  - `template_edges`: Contains the template images.
- **Output Directories**:
  - `rotated_lines`: Processed images with detected lines from the `rotated_edges` directory.
  - `template_lines`: Processed images with detected lines from the `template_edges` directory.
  - `rotated_edges`: Contains the rotation-corrected images after processing.

### Usage
1. Place your rotated images in the `rotated_edges` directory and template images in the `template_edges` directory.
2. Run the script to perform edge detection, line fitting, and histogram comparison.
3. The estimated rotation angles will be calculated and used to correct the rotation of the images.
4. The corrected images will be saved in the `rotated_edges` directory.

### Requirements
- Python 3.x
- OpenCV
- NumPy
- Matplotlib

### License
This project is licensed under the MIT License.
